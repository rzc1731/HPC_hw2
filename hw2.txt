2. Optimizing matrix-matrix multiplication.
I am using CIMS snappy1 machine which has Two Intel Xeon E5-2680 (2.80 GHz) (20 cores), 128 GB Memory, 25600 KB cache size.

JPI
 Dimension       Time    Gflop/s       GB/s        Error
        16   0.419862   4.763472   9.526945 0.000000e+00
        64   0.416514   4.802142   9.604284 0.000000e+00
       112   0.418038   4.785728   9.571455 0.000000e+00
       160   0.419321   4.786407   9.572815 0.000000e+00
       208   0.425933   4.732571   9.465142 0.000000e+00
       256   0.517723   3.888696   7.777392 0.000000e+00
       304   0.425988   4.748490   9.496979 0.000000e+00
       352   0.429832   4.667528   9.335055 0.000000e+00
       400   0.435343   4.704341   9.408682 0.000000e+00
       448   0.467486   4.616118   9.232236 0.000000e+00
       496   0.468894   4.684283   9.368567 0.000000e+00
       544   0.481803   4.677947   9.355894 0.000000e+00
       592   0.434629   4.773604   9.547209 0.000000e+00
       640   0.463666   4.522984   9.045968 0.000000e+00
       688   0.552778   4.713074   9.426149 0.000000e+00
       736   0.512074   4.671454   9.342908 0.000000e+00
       784   0.609049   4.747305   9.494611 0.000000e+00
       832   0.500995   4.598294   9.196589 0.000000e+00
       880   0.581923   4.684279   9.368557 0.000000e+00
       928   0.692253   4.617840   9.235679 0.000000e+00
       976   0.809919   4.591638   9.183277 0.000000e+00
      1024   0.639289   3.359173   6.718346 0.000000e+00
      1072   0.537780   4.581518   9.163037 0.000000e+00
      1120   0.616091   4.560781   9.121562 0.000000e+00
      1168   0.728918   4.371996   8.743992 0.000000e+00
      1216   0.836766   4.297607   8.595214 0.000000e+00
      1264   0.880223   4.588582   9.177163 0.000000e+00
      1312   0.994707   4.540841   9.081681 0.000000e+00
      1360   1.164635   4.319732   8.639465 0.000000e+00
      1408   1.341153   4.162552   8.325105 0.000000e+00
      1456   1.362239   4.531697   9.063394 0.000000e+00
      1504   1.650691   4.121998   8.243997 0.000000e+00
      1552   1.672418   4.470543   8.941086 0.000000e+00
      1600   1.909160   4.290893   8.581786 0.000000e+00
      1648   2.101752   4.259123   8.518246 0.000000e+00
      1696   2.763235   3.530935   7.061870 0.000000e+00
      1744   2.404712   4.411705   8.823409 0.000000e+00
      1792   3.200293   3.596286   7.192572 0.000000e+00
      1840   2.891595   4.308698   8.617396 0.000000e+00
      1888   3.552464   3.788840   7.577680 0.000000e+00
      1936   3.249867   4.465606   8.931212 0.000000e+00
      1984   3.586866   4.354516   8.709032 0.000000e+00

PJI
Dimension       Time    Gflop/s       GB/s        Error
        16   0.548470   3.646510   7.293020 0.000000e+00
        64   0.537927   3.718273   7.436547 0.000000e+00
       112   0.539944   3.705230   7.410461 0.000000e+00
       160   0.537314   3.735323   7.470645 0.000000e+00
       208   0.540057   3.732489   7.464978 0.000000e+00
       256   0.577214   3.487904   6.975808 0.000000e+00
       304   0.549276   3.682670   7.365340 0.000000e+00
       352   0.550601   3.643750   7.287500 0.000000e+00
       400   0.558219   3.668814   7.337628 0.000000e+00
       448   0.590867   3.652207   7.304414 0.000000e+00
       496   0.601450   3.651894   7.303788 0.000000e+00
       544   0.603568   3.734211   7.468421 0.000000e+00
       592   0.562042   3.691442   7.382885 0.000000e+00
       640   0.576949   3.634902   7.269804 0.000000e+00
       688   0.705707   3.691737   7.383473 0.000000e+00
       736   0.648087   3.691063   7.382126 0.000000e+00
       784   0.797865   3.623848   7.247697 0.000000e+00
       832   0.631209   3.649696   7.299391 0.000000e+00
       880   0.738087   3.693181   7.386363 0.000000e+00
       928   0.877228   3.644109   7.288217 0.000000e+00
       976   1.025326   3.627000   7.254001 0.000000e+00
      1024   0.810271   2.650328   5.300655 0.000000e+00
      1072   0.720788   3.418274   6.836548 0.000000e+00
      1120   0.767874   3.659266   7.318533 0.000000e+00
      1168   0.902718   3.530259   7.060517 0.000000e+00
      1216   0.980194   3.668756   7.337513 0.000000e+00
      1264   1.178538   3.427107   6.854215 0.000000e+00
      1312   1.260790   3.582521   7.165042 0.000000e+00
      1360   1.582355   3.179382   6.358765 0.000000e+00
      1408   1.593500   3.503369   7.006739 0.000000e+00
      1456   1.871404   3.298728   6.597455 0.000000e+00
      1504   2.243471   3.032864   6.065729 0.000000e+00
      1552   2.088627   3.579680   7.159360 0.000000e+00
      1600   2.307445   3.550247   7.100493 0.000000e+00
      1648   2.636526   3.395233   6.790466 0.000000e+00
      1696   3.195085   3.053691   6.107382 0.000000e+00
      1744   2.997498   3.539244   7.078488 0.000000e+00
      1792   3.545638   3.246008   6.492016 0.000000e+00
      1840   3.654845   3.408902   6.817804 0.000000e+00
      1888   4.017058   3.350640   6.701281 0.000000e+00
      1936   4.194798   3.459672   6.919345 0.000000e+00
      1984   4.379332   3.566540   7.133080 0.000000e+00

PIJ
Dimension       Time    Gflop/s       GB/s        Error
        16   0.920297   2.173215   4.346430 0.000000e+00
        64   0.926844   2.158031   4.316062 0.000000e+00
       112   0.923520   2.166295   4.332590 0.000000e+00
       160   0.924609   2.170691   4.341382 0.000000e+00
       208   0.930343   2.166681   4.333362 0.000000e+00
       256   1.168110   1.723525   3.447050 0.000000e+00
       304   0.933862   2.166060   4.332119 0.000000e+00
       352   0.948310   2.115609   4.231217 0.000000e+00
       400   0.993513   2.061372   4.122745 0.000000e+00
       448   1.064288   2.027618   4.055237 0.000000e+00
       496   1.068036   2.056513   4.113027 0.000000e+00
       544   1.110395   2.029773   4.059545 0.000000e+00
       592   1.008829   2.056589   4.113178 0.000000e+00
       640   0.988735   2.121046   4.242091 0.000000e+00
       688   1.271709   2.048648   4.097297 0.000000e+00
       736   1.147987   2.083760   4.167519 0.000000e+00
       784   1.439698   2.008297   4.016595 0.000000e+00
       832   1.143417   2.014769   4.029537 0.000000e+00
       880   1.314164   2.074238   4.148476 0.000000e+00
       928   1.610529   1.984885   3.969770 0.000000e+00
       976   1.925853   1.931018   3.862036 0.000000e+00
      1024   4.565283   0.470394   0.940789 0.000000e+00
      1072   1.296684   1.900116   3.800231 0.000000e+00
      1120   1.413296   1.988159   3.976317 0.000000e+00
      1168   1.583048   2.013096   4.026191 0.000000e+00
      1216   1.843205   1.950999   3.901999 0.000000e+00
      1264   2.037284   1.982529   3.965058 0.000000e+00
      1312   2.303981   1.960436   3.920872 0.000000e+00
      1360   2.550301   1.972674   3.945347 0.000000e+00
      1408   2.895851   1.927799   3.855598 0.000000e+00
      1456   3.159763   1.953708   3.907416 0.000000e+00
      1504   3.483120   1.953463   3.906925 0.000000e+00
      1552   3.818123   1.958192   3.916384 0.000000e+00
      1600   4.285412   1.911602   3.823203 0.000000e+00
      1648   4.602411   1.944985   3.889970 0.000000e+00
      1696   5.057375   1.929223   3.858446 0.000000e+00
      1744   5.413597   1.959672   3.919345 0.000000e+00
      1792   6.759872   1.702572   3.405145 0.000000e+00
      1840   6.711063   1.856488   3.712976 0.000000e+00
      1888   6.838333   1.968275   3.936550 0.000000e+00
      1936   7.444967   1.949321   3.898641 0.000000e+00
      1984   8.068395   1.935833   3.871666 0.000000e+00

IPJ
Dimension       Time    Gflop/s       GB/s        Error
        16   0.920043   2.173815   4.347630 0.000000e+00
        64   0.921454   2.170655   4.341310 0.000000e+00
       112   0.930208   2.150720   4.301440 0.000000e+00
       160   0.926174   2.167024   4.334047 0.000000e+00
       208   0.941453   2.141113   4.282226 0.000000e+00
       256   1.565305   1.286181   2.572363 0.000000e+00
       304   0.973600   2.077651   4.155302 0.000000e+00
       352   0.966782   2.075187   4.150374 0.000000e+00
       400   1.004926   2.037961   4.075921 0.000000e+00
       448   1.083386   1.991875   3.983749 0.000000e+00
       496   1.106287   1.985408   3.970816 0.000000e+00
       544   1.118537   2.014997   4.029995 0.000000e+00
       592   1.033068   2.008335   4.016671 0.000000e+00
       640   1.060387   1.977723   3.955446 0.000000e+00
       688   1.297480   2.007958   4.015917 0.000000e+00
       736   1.221840   1.957809   3.915617 0.000000e+00
       784   1.475875   1.959070   3.918140 0.000000e+00
       832   1.130546   2.037707   4.075415 0.000000e+00
       880   1.383867   1.969762   3.939523 0.000000e+00
       928   1.580569   2.022509   4.045018 0.000000e+00
       976   1.830711   2.031373   4.062746 0.000000e+00
      1024   5.512040   0.389599   0.779197 0.000000e+00
      1072   1.265688   1.946649   3.893297 0.000000e+00
      1120   1.415848   1.984575   3.969150 0.000000e+00
      1168   1.616743   1.971140   3.942281 0.000000e+00
      1216   1.829939   1.965143   3.930287 0.000000e+00
      1264   2.078826   1.942912   3.885824 0.000000e+00
      1312   2.342030   1.928587   3.857173 0.000000e+00
      1360   2.595681   1.938186   3.876372 0.000000e+00
      1408   2.758686   2.023651   4.047303 0.000000e+00
      1456   3.185804   1.937738   3.875476 0.000000e+00
      1504   3.495043   1.946798   3.893597 0.000000e+00
      1552   3.829827   1.952208   3.904415 0.000000e+00
      1600   4.213237   1.944348   3.888696 0.000000e+00
      1648   4.622091   1.936703   3.873407 0.000000e+00
      1696   5.005013   1.949406   3.898812 0.000000e+00
      1744   5.447915   1.947328   3.894656 0.000000e+00
      1792   9.045420   1.272375   2.544751 0.000000e+00
      1840   6.533947   1.906812   3.813624 0.000000e+00
      1888   7.079563   1.901207   3.802415 0.000000e+00
      1936   7.892796   1.838718   3.677436 0.000000e+00
      1984   8.114112   1.924926   3.849852 0.000000e+00

IJP
Dimension       Time    Gflop/s       GB/s        Error
        16   0.955388   2.093393   4.186786 0.000000e+00
        64   0.955489   2.093336   4.186672 0.000000e+00
       112   0.955907   2.092900   4.185801 0.000000e+00
       160   0.959953   2.090769   4.181538 0.000000e+00
       208   0.973874   2.069833   4.139667 0.000000e+00
       256   1.179341   1.707111   3.414222 0.000000e+00
       304   0.992528   2.038029   4.076059 0.000000e+00
       352   1.001086   2.004078   4.008156 0.000000e+00
       400   1.014840   2.018052   4.036103 0.000000e+00
       448   1.101568   1.958997   3.917994 0.000000e+00
       496   1.096538   2.003059   4.006118 0.000000e+00
       544   1.130577   1.993537   3.987075 0.000000e+00
       592   0.997446   2.080060   4.160119 0.000000e+00
       640   1.142542   1.835514   3.671028 0.000000e+00
       688   1.276281   2.041310   4.082619 0.000000e+00
       736   1.200521   1.992576   3.985152 0.000000e+00
       784   1.410392   2.050028   4.100055 0.000000e+00
       832   1.181370   1.950043   3.900085 0.000000e+00
       880   1.350631   2.018232   4.036465 0.000000e+00
       928   1.580576   2.022500   4.045000 0.000000e+00
       976   1.831051   2.030996   4.061991 0.000000e+00
      1024   1.617394   1.327743   2.655487 0.000000e+00
      1072   1.187065   2.075581   4.151162 0.000000e+00
      1120   1.402073   2.004073   4.008146 0.000000e+00
      1168   1.588282   2.006462   4.012923 0.000000e+00
      1216   1.837386   1.957178   3.914356 0.000000e+00
      1264   2.016863   2.002602   4.005205 0.000000e+00
      1312   2.257364   2.000921   4.001842 0.000000e+00
      1360   2.478746   2.029620   4.059239 0.000000e+00
      1408   2.981763   1.872254   3.744508 0.000000e+00
      1456   3.054256   2.021197   4.042394 0.000000e+00
      1504   3.408933   1.995975   3.991949 0.000000e+00
      1552   3.688962   2.026754   4.053507 0.000000e+00
      1600   4.147839   1.975004   3.950009 0.000000e+00
      1648   4.403940   2.032639   4.065277 0.000000e+00
      1696   4.868228   2.004180   4.008359 0.000000e+00
      1744   5.232554   2.027476   4.054952 0.000000e+00
      1792   6.866679   1.676090   3.352180 0.000000e+00
      1840   6.170895   2.018995   4.037990 0.000000e+00
      1888   6.742383   1.996285   3.992570 0.000000e+00
      1936   7.172672   2.023322   4.046645 0.000000e+00
      1984   7.983358   1.956453   3.912906 0.000000e+00

JIP
Dimension       Time    Gflop/s       GB/s        Error
        16   0.935946   2.136879   4.273758 0.000000e+00
        64   0.943766   2.119338   4.238676 0.000000e+00
       112   0.934977   2.139750   4.279501 0.000000e+00
       160   0.940794   2.133347   4.266694 0.000000e+00
       208   0.945541   2.131855   4.263711 0.000000e+00
       256   0.945324   2.129710   4.259419 0.000000e+00
       304   0.953396   2.121680   4.243359 0.000000e+00
       352   0.941700   2.130458   4.260917 0.000000e+00
       400   0.963204   2.126237   4.252473 0.000000e+00
       448   1.019524   2.116645   4.233289 0.000000e+00
       496   1.043498   2.104874   4.209748 0.000000e+00
       544   1.071852   2.102760   4.205521 0.000000e+00
       592   0.980398   2.116229   4.232459 0.000000e+00
       640   0.969512   2.163100   4.326200 0.000000e+00
       688   1.257408   2.071948   4.143897 0.000000e+00
       736   1.180909   2.025668   4.051335 0.000000e+00
       784   1.407292   2.054543   4.109087 0.000000e+00
       832   1.156733   1.991575   3.983151 0.000000e+00
       880   1.351949   2.016265   4.032531 0.000000e+00
       928   1.603946   1.993031   3.986062 0.000000e+00
       976   1.859448   1.999978   3.999957 0.000000e+00
      1024   1.046782   2.051509   4.103019 0.000000e+00
      1072   1.237599   1.990832   3.981663 0.000000e+00
      1120   1.389598   2.022063   4.044127 0.000000e+00
      1168   1.710192   1.863432   3.726864 0.000000e+00
      1216   1.802904   1.994611   3.989222 0.000000e+00
      1264   2.087516   1.934824   3.869648 0.000000e+00
      1312   2.312114   1.953540   3.907080 0.000000e+00
      1360   2.663786   1.888632   3.777264 0.000000e+00
      1408   2.858406   1.953053   3.906106 0.000000e+00
      1456   3.274134   1.885462   3.770923 0.000000e+00
      1504   3.706048   1.835957   3.671913 0.000000e+00
      1552   3.844894   1.944557   3.889115 0.000000e+00
      1600   4.208439   1.946565   3.893130 0.000000e+00
      1648   4.609548   1.941973   3.883947 0.000000e+00
      1696   5.001246   1.950874   3.901749 0.000000e+00
      1744   5.468859   1.939871   3.879741 0.000000e+00
      1792   5.459284   2.108183   4.216366 0.000000e+00
      1840   6.404442   1.945370   3.890740 0.000000e+00
      1888   6.986427   1.926553   3.853105 0.000000e+00
      1936   7.490516   1.937467   3.874934 0.000000e+00
      1984   8.134256   1.920159   3.840318 0.000000e+00

We can see that the ordering of JPI is the fastest one. JPI is a little bit faster than PJI and much faster (about factor 
of 2) than the other orderings because it utilize the cache most by having smallest stride when accessing matrices a,b,c.
In the JPI case, the stride for accessing matrix a and c is only 1, and the stride for accessing matrix b is 0, so put I in 
the most inner loop is the best choice. Also, between p and j, j appears twice inside the multiplication (j*k and j*m), but
p only appears once inside and once outside the multiplication. Therefore, put p in the more inner loop can reduce the 
overall stride when accessing matrices a,b,c.

BLOCK_SIZE = 8
Dimension       Time    Gflop/s       GB/s        Error
         8   0.662725   3.017842   6.035685 0.000000e+00
        56   0.626151   3.194542   6.389085 0.000000e+00
       104   0.626608   3.191800   6.383600 0.000000e+00
       152   0.629663   3.179052   6.358104 0.000000e+00
       200   0.640709   3.146513   6.293025 0.000000e+00
       248   0.630075   3.195484   6.390969 0.000000e+00
       296   0.646919   3.126940   6.253880 0.000000e+00
       344   0.651113   3.126002   6.252004 0.000000e+00
       392   0.653477   3.134058   6.268115 0.000000e+00
       440   0.644349   3.172838   6.345675 0.000000e+00
       488   0.663548   3.152533   6.305065 0.000000e+00
       536   0.674366   3.196884   6.393769 0.000000e+00
       584   0.756816   3.158128   6.316256 0.000000e+00
       632   0.639842   3.156230   6.312461 0.000000e+00
       680   0.800686   3.141627   6.283255 0.000000e+00
       728   0.726629   3.185904   6.371809 0.000000e+00
       776   0.885000   3.168058   6.336117 0.000000e+00
       824   0.708047   3.160673   6.321345 0.000000e+00
       872   0.829626   3.196884   6.393768 0.000000e+00
       920   0.983697   3.166374   6.332748 0.000000e+00
       968   1.133502   3.200838   6.401676 0.000000e+00
      1016   0.668110   3.139518   6.279035 0.000000e+00
      1064   0.767328   3.139598   6.279196 0.000000e+00
      1112   0.868998   3.164648   6.329296 0.000000e+00
      1160   0.993125   3.143403   6.286805 0.000000e+00
      1208   1.130431   3.118794   6.237588 0.000000e+00
      1256   1.270502   3.119059   6.238118 0.000000e+00
      1304   1.414094   3.136060   6.272120 0.000000e+00
      1352   1.581654   3.124989   6.249978 0.000000e+00
      1400   1.758434   3.120959   6.241917 0.000000e+00
      1448   1.955312   3.105415   6.210829 0.000000e+00
      1496   2.134336   3.137343   6.274686 0.000000e+00
      1544   2.390678   3.079292   6.158583 0.000000e+00
      1592   2.616493   3.084179   6.168359 0.000000e+00
      1640   2.833478   3.113448   6.226897 0.000000e+00
      1688   3.117677   3.085433   6.170867 0.000000e+00
      1736   3.361288   3.112959   6.225918 0.000000e+00
      1784   3.682629   3.083590   6.167180 0.000000e+00
      1832   3.919703   3.137280   6.274559 0.000000e+00
      1880   4.289233   3.098303   6.196607 0.000000e+00
      1928   4.591581   3.121683   6.243366 0.000000e+00
      1976   4.976966   3.100460   6.200920 0.000000e+00

BLOCK_SIZE = 16
 Dimension       Time    Gflop/s       GB/s        Error
        16   0.419862   4.763472   9.526945 0.000000e+00
        64   0.416514   4.802142   9.604284 0.000000e+00
       112   0.418038   4.785728   9.571455 0.000000e+00
       160   0.419321   4.786407   9.572815 0.000000e+00
       208   0.425933   4.732571   9.465142 0.000000e+00
       256   0.517723   3.888696   7.777392 0.000000e+00
       304   0.425988   4.748490   9.496979 0.000000e+00
       352   0.429832   4.667528   9.335055 0.000000e+00
       400   0.435343   4.704341   9.408682 0.000000e+00
       448   0.467486   4.616118   9.232236 0.000000e+00
       496   0.468894   4.684283   9.368567 0.000000e+00
       544   0.481803   4.677947   9.355894 0.000000e+00
       592   0.434629   4.773604   9.547209 0.000000e+00
       640   0.463666   4.522984   9.045968 0.000000e+00
       688   0.552778   4.713074   9.426149 0.000000e+00
       736   0.512074   4.671454   9.342908 0.000000e+00
       784   0.609049   4.747305   9.494611 0.000000e+00
       832   0.500995   4.598294   9.196589 0.000000e+00
       880   0.581923   4.684279   9.368557 0.000000e+00
       928   0.692253   4.617840   9.235679 0.000000e+00
       976   0.809919   4.591638   9.183277 0.000000e+00
      1024   0.639289   3.359173   6.718346 0.000000e+00
      1072   0.537780   4.581518   9.163037 0.000000e+00
      1120   0.616091   4.560781   9.121562 0.000000e+00
      1168   0.728918   4.371996   8.743992 0.000000e+00
      1216   0.836766   4.297607   8.595214 0.000000e+00
      1264   0.880223   4.588582   9.177163 0.000000e+00
      1312   0.994707   4.540841   9.081681 0.000000e+00
      1360   1.164635   4.319732   8.639465 0.000000e+00
      1408   1.341153   4.162552   8.325105 0.000000e+00
      1456   1.362239   4.531697   9.063394 0.000000e+00
      1504   1.650691   4.121998   8.243997 0.000000e+00
      1552   1.672418   4.470543   8.941086 0.000000e+00
      1600   1.909160   4.290893   8.581786 0.000000e+00
      1648   2.101752   4.259123   8.518246 0.000000e+00
      1696   2.763235   3.530935   7.061870 0.000000e+00
      1744   2.404712   4.411705   8.823409 0.000000e+00
      1792   3.200293   3.596286   7.192572 0.000000e+00
      1840   2.891595   4.308698   8.617396 0.000000e+00
      1888   3.552464   3.788840   7.577680 0.000000e+00
      1936   3.249867   4.465606   8.931212 0.000000e+00
      1984   3.586866   4.354516   8.709032 0.000000e+00

BLOCK_SIZE = 32
Dimension       Time    Gflop/s       GB/s        Error
        32   0.324213   6.168872  12.337744 0.000000e+00
        64   0.327318   6.110760  12.221520 0.000000e+00
        96   0.326665   6.126381  12.252761 0.000000e+00
       128   0.334759   5.976485  11.952970 0.000000e+00
       160   0.325084   6.173915  12.347830 0.000000e+00
       192   0.322695   6.229172  12.458344 0.000000e+00
       224   0.320340   6.245297  12.490593 0.000000e+00
       256   0.407939   4.935215   9.870429 0.000000e+00
       288   0.330489   6.071547  12.143094 0.000000e+00
       320   0.336687   6.034135  12.068270 0.000000e+00
       352   0.340127   5.898535  11.797070 0.000000e+00
       384   0.417145   4.886627   9.773253 0.000000e+00
       416   0.337268   5.976726  11.953453 0.000000e+00
       448   0.367128   5.877978  11.755956 0.000000e+00
       480   0.378150   5.849104  11.698208 0.000000e+00
       512   0.452692   4.743811   9.487623 0.000000e+00
       544   0.376602   5.984695  11.969391 0.000000e+00
       576   0.396085   5.789751  11.579503 0.000000e+00
       608   0.380701   5.903736  11.807472 0.000000e+00
       640   0.408143   5.138281  10.276562 0.000000e+00
       672   0.408808   5.938520  11.877039 0.000000e+00
       704   0.359304   5.826495  11.652989 0.000000e+00
       736   0.404203   5.918135  11.836270 0.000000e+00
       768   0.560207   4.851612   9.703224 0.000000e+00
       800   0.360380   5.682893  11.365786 0.000000e+00
       832   0.392504   5.869293  11.738586 0.000000e+00
       864   0.450947   5.721055  11.442110 0.000000e+00
       896   0.542362   5.305114  10.610228 0.000000e+00
       928   0.580904   5.503002  11.006005 0.000000e+00
       960   0.639482   5.534079  11.068158 0.000000e+00
       992   0.786224   4.966483   9.932966 0.000000e+00
      1024   0.488202   4.398757   8.797514 0.000000e+00
      1056   0.424261   5.551228  11.102456 0.000000e+00
      1088   0.474788   5.425214  10.850429 0.000000e+00
      1120   0.523378   5.368693  10.737385 0.000000e+00
      1152   0.591072   5.173051  10.346102 0.000000e+00
      1184   0.616866   5.381387  10.762775 0.000000e+00
      1216   0.667134   5.390361  10.780721 0.000000e+00
      1248   0.755092   5.148417  10.296835 0.000000e+00
      1280   0.874676   4.795268   9.590535 0.000000e+00
      1312   0.844705   5.347203  10.694406 0.000000e+00
      1344   0.903296   5.375237  10.750473 0.000000e+00
      1376   0.969074   5.376854  10.753709 0.000000e+00
      1408   1.056569   5.283723  10.567445 0.000000e+00
      1440   1.126599   5.300884  10.601767 0.000000e+00
      1472   1.281620   4.977302   9.954605 0.000000e+00
      1504   1.364646   4.986014   9.972029 0.000000e+00
      1536   1.582810   4.579045   9.158089 0.000000e+00
      1568   1.515780   5.086652  10.173304 0.000000e+00
      1600   1.636732   5.005096  10.010192 0.000000e+00
      1632   1.630245   5.332581  10.665162 0.000000e+00
      1664   1.767872   5.212417  10.424834 0.000000e+00
      1696   1.964388   4.966840   9.933681 0.000000e+00
      1728   1.920532   5.373283  10.746566 0.000000e+00
      1760   2.023993   5.387150  10.774299 0.000000e+00
      1792   2.389888   4.815779   9.631557 0.000000e+00
      1824   2.273329   5.338782  10.677565 0.000000e+00
      1856   2.441618   5.237043  10.474086 0.000000e+00
      1888   2.557127   5.263610  10.527220 0.000000e+00
      1920   2.714237   5.215379  10.430758 0.000000e+00
      1952   2.816241   5.282014  10.564028 0.000000e+00
      1984   2.990119   5.223560  10.447120 0.000000e+00

BLOCK_SIZE = 64
Dimension       Time    Gflop/s       GB/s        Error
        64   0.286240   6.987694  13.975388 0.000000e+00
       128   0.342502   5.841371  11.682743 0.000000e+00
       192   0.310830   6.466935  12.933870 0.000000e+00
       256   0.355082   5.669862  11.339724 0.000000e+00
       320   0.317647   6.395831  12.791663 0.000000e+00
       384   0.345221   5.904721  11.809442 0.000000e+00
       448   0.341369   6.321523  12.643047 0.000000e+00
       512   0.486055   4.418194   8.836388 0.000000e+00
       576   0.377272   6.078462  12.156924 0.000000e+00
       640   0.366476   5.722485  11.444970 0.000000e+00
       704   0.341267   6.134438  12.268877 0.000000e+00
       768   0.496604   5.472989  10.945978 0.000000e+00
       832   0.382089   6.029281  12.058562 0.000000e+00
       896   0.503419   5.715505  11.431010 0.000000e+00
       960   0.569317   6.216126  12.432252 0.000000e+00
      1024   0.504897   4.253308   8.506617 0.000000e+00
      1088   0.420227   6.129613  12.259226 0.000000e+00
      1152   0.536652   5.697632  11.395265 0.000000e+00
      1216   0.579845   6.201817  12.403635 0.000000e+00
      1280   0.735707   5.701055  11.402110 0.000000e+00
      1344   0.776466   6.253242  12.506484 0.000000e+00
      1408   0.967984   5.767262  11.534524 0.000000e+00
      1472   1.059103   6.023032  12.046063 0.000000e+00
      1536   1.353117   5.356340  10.712680 0.000000e+00
      1600   1.342132   6.103720  12.207440 0.000000e+00
      1664   1.613361   5.711609  11.423217 0.000000e+00
      1728   1.699667   6.071520  12.143040 0.000000e+00
      1792   2.008384   5.730563  11.461126 0.000000e+00
      1856   2.055358   6.221233  12.442466 0.000000e+00
      1920   2.470563   5.729777  11.459554 0.000000e+00
      1984   2.514891   6.210631  12.421263 0.000000e+00

BLOCK_SIZE = 92
 Dimension       Time    Gflop/s       GB/s        Error
        92   0.312146   6.411199  12.822397 0.000000e+00
       184   0.337626   5.941186  11.882372 0.000000e+00
       276   0.337747   5.975952  11.951904 0.000000e+00
       368   0.356168   5.876765  11.753529 0.000000e+00
       460   0.364505   5.874797  11.749594 0.000000e+00
       552   0.358390   5.631739  11.263479 0.000000e+00
       644   0.371876   5.745780  11.491561 0.000000e+00
       736   0.408779   5.851892  11.703784 0.000000e+00
       828   0.391140   5.805226  11.610452 0.000000e+00
       920   0.527482   5.904940  11.809881 0.000000e+00
      1012   0.356722   5.810883  11.621767 0.000000e+00
      1104   0.455057   5.913868  11.827736 0.000000e+00
      1196   0.575186   5.948606  11.897211 0.000000e+00
      1288   0.729742   5.856093  11.712186 0.000000e+00
      1380   0.889184   5.911201  11.822402 0.000000e+00
      1472   1.071742   5.952006  11.904011 0.000000e+00
      1564   1.277366   5.989972  11.979944 0.000000e+00
      1656   1.519011   5.979296  11.958593 0.000000e+00
      1748   1.782000   5.994412  11.988824 0.000000e+00
      1840   2.070366   6.017782  12.035563 0.000000e+00
      1932   2.404030   5.999451  11.998902 0.000000e+00

BLOCK_SIZE = 96
 Dimension       Time    Gflop/s       GB/s        Error
        96   0.312866   6.396579  12.793159 0.000000e+00
       192   0.331029   6.072347  12.144694 0.000000e+00
       288   0.341777   5.871030  11.742059 0.000000e+00
       384   0.340182   5.992181  11.984361 0.000000e+00
       480   0.374358   5.908353  11.816706 0.000000e+00
       576   0.392645   5.840488  11.680975 0.000000e+00
       672   0.400104   6.067707  12.135414 0.000000e+00
       768   0.485845   5.594189  11.188378 0.000000e+00
       864   0.426748   6.045469  12.090938 0.000000e+00
       960   0.591520   5.982799  11.965599 0.000000e+00
      1056   0.392071   6.006987  12.013975 0.000000e+00
      1152   0.497199   6.149740  12.299481 0.000000e+00
      1248   0.642475   6.050863  12.101725 0.000000e+00
      1344   0.792277   6.128455  12.256910 0.000000e+00
      1440   0.988055   6.044167  12.088334 0.000000e+00
      1536   1.603366   4.520340   9.040679 0.000000e+00
      1632   1.438659   6.042723  12.085446 0.000000e+00
      1728   1.688008   6.113456  12.226911 0.000000e+00
      1824   2.002500   6.060827  12.121655 0.000000e+00
      1920   2.325596   6.086945  12.173890 0.000000e+00

BLOCK_SIZE = 100
Dimension       Time    Gflop/s       GB/s        Error
       100   0.306655   6.528511  13.057023 0.000000e+00
       200   0.336322   5.994260  11.988520 0.000000e+00
       300   0.338772   6.057169  12.114338 0.000000e+00
       400   0.364004   5.626313  11.252625 0.000000e+00
       500   0.385062   5.843216  11.686433 0.000000e+00
       600   0.376579   5.735844  11.471688 0.000000e+00
       700   0.361009   5.700694  11.401387 0.000000e+00
       800   0.336834   6.080140  12.160281 0.000000e+00
       900   0.494364   5.898491  11.796983 0.000000e+00
      1000   0.669440   5.975140  11.950280 0.000000e+00
      1100   0.437325   6.087006  12.174012 0.000000e+00
      1200   0.567235   6.092711  12.185422 0.000000e+00
      1300   0.737927   5.954516  11.909032 0.000000e+00
      1400   0.902493   6.080931  12.161862 0.000000e+00
      1500   1.125655   5.996510  11.993020 0.000000e+00
      1600   1.357261   6.035687  12.071374 0.000000e+00
      1700   1.622471   6.056196  12.112393 0.000000e+00
      1800   1.924313   6.061384  12.122768 0.000000e+00
      1900   2.259397   6.071531  12.143061 0.000000e+00

BLOCK_SIZE = 128
 Dimension       Time    Gflop/s       GB/s        Error
       128   0.340158   5.881635  11.763271 0.000000e+00
       256   0.401208   5.018005  10.036009 0.000000e+00
       384   0.407164   5.006412  10.012824 0.000000e+00
       512   0.488559   4.395545   8.791090 0.000000e+00
       640   0.396715   5.286296  10.572593 0.000000e+00
       768   0.537582   5.055804  10.111609 0.000000e+00
       896   0.536151   5.366571  10.733142 0.000000e+00
      1024   0.486888   4.410636   8.821272 0.000000e+00
      1152   0.566470   5.397724  10.795449 0.000000e+00
      1280   0.825432   5.081343  10.162685 0.000000e+00
      1408   1.031807   5.410527  10.821053 0.000000e+00
      1536   1.627896   4.452224   8.904448 0.000000e+00
      1664   1.694479   5.438183  10.876366 0.000000e+00
      1792   2.248871   5.117756  10.235511 0.000000e+00
      1920   2.563743   5.521528  11.043056 0.000000e+00

The optimal value for BLOCK_SIZE is 96, but 100 is very similar to 96.


The peak flop-rate is 2.8 GHz * 16 flops/cycle * 20 cores = 896 GFLOPS
To avoid massive time of creating threads, I tested openmp version of code for BLOCK_SIZE = 32 instead of 16

 Dimension       Time    Gflop/s       GB/s        Error
        32  99.622323   0.020076   0.040152 0.000000e+00
        64  12.517830   0.159785   0.319570 0.000000e+00
        96   3.794591   0.527401   1.054803 0.000000e+00
       128   1.665409   1.201317   2.402633 0.000000e+00
       160   0.818825   2.451122   4.902244 0.000000e+00
       192   0.534993   3.757282   7.514564 0.000000e+00
       224   0.342824   5.835696  11.671392 0.000000e+00
       256   0.240364   8.375888  16.751775 0.000000e+00
       288   0.172071  11.661363  23.322726 0.000000e+00
       320   0.134843  15.066522  30.133044 0.000000e+00
       352   0.105488  19.018787  38.037574 0.000000e+00
       384   0.094338  21.607663  43.215327 0.000000e+00
       416   0.073472  27.435679  54.871358 0.000000e+00
       448   0.067403  32.016134  64.032267 0.000000e+00
       480   0.065421  33.809342  67.618684 0.000000e+00
       512   0.056622  37.926817  75.853635 0.000000e+00
       544   0.066578  33.852720  67.705440 0.000000e+00
       576   0.063175  36.299515  72.599031 0.000000e+00
       608   0.056336  39.895907  79.791813 0.000000e+00
       640   0.052589  39.877779  79.755557 0.000000e+00
       672   0.057676  42.092594  84.185188 0.000000e+00
       704   0.044695  46.839021  93.678042 0.000000e+00
       736   0.060456  39.568248  79.136496 0.000000e+00
       768   0.067950  39.998771  79.997541 0.000000e+00
       800   0.043584  46.990147  93.980294 0.000000e+00
       832   0.048746  47.259483  94.518965 0.000000e+00
       864   0.057359  44.977565  89.955130 0.000000e+00
       896   0.063279  45.469659  90.939318 0.000000e+00
       928   0.066937  47.756773  95.513545 0.000000e+00
       960   0.068889  51.371965 102.743931 0.000000e+00
       992   0.078435  49.783423  99.566847 0.000000e+00
      1024   0.047916  44.817742  89.635484 0.000000e+00
      1056   0.040509  58.139955 116.279909 0.000000e+00
      1088   0.043621  59.050136 118.100273 0.000000e+00
      1120   0.048486  57.951743 115.903487 0.000000e+00
      1152   0.050520  60.523529 121.047059 0.000000e+00
      1184   0.056823  58.420187 116.840375 0.000000e+00
      1216   0.059056  60.892949 121.785898 0.000000e+00
      1248   0.067951  57.210882 114.421763 0.000000e+00
      1280   0.069331  60.496749 120.993499 0.000000e+00
      1312   0.073304  61.617675 123.235350 0.000000e+00
      1344   0.068610  70.768720 141.537439 0.000000e+00
      1376   0.072282  72.086677 144.173353 0.000000e+00
      1408   0.073114  76.355337 152.710674 0.000000e+00
      1440   0.103188  57.874815 115.749630 0.000000e+00
      1472   0.108068  59.027861 118.055722 0.000000e+00
      1504   0.110723  61.451897 122.903793 0.000000e+00
      1536   0.129406  56.007704 112.015409 0.000000e+00
      1568   0.129016  59.762157 119.524313 0.000000e+00
      1600   0.126041  64.994692 129.989384 0.000000e+00
      1632   0.131260  66.230690 132.461380 0.000000e+00
      1664   0.138211  66.672472 133.344944 0.000000e+00
      1696   0.154994  62.949624 125.899247 0.000000e+00
      1728   0.151177  68.261627 136.523254 0.000000e+00
      1760   0.154861  70.408652 140.817304 0.000000e+00
      1792   0.179810  64.007328 128.014656 0.000000e+00
      1824   0.193963  62.572823 125.145645 0.000000e+00
      1856   0.197620  64.704312 129.408624 0.000000e+00
      1888   0.201513  66.793177 133.586354 0.000000e+00
      1920   0.204050  69.374115 138.748230 0.000000e+00
      1952   0.214888  69.223981 138.447961 0.000000e+00
      1984   0.225490  69.267323 138.534645 0.000000e+00

76.355337 / 896 * 100 = 8.5218 % of the peak FLOP-rate is achieved with my code.

4. OpenMP version of 2D Jacobi/Gauss-Seidel smoothing.
I am using CIMS snappy1 machine which has Two Intel Xeon E5-2680 (2.80 GHz) (20 cores), 128 GB Memory, 25600 KB cache size.
S means compling without OpenMP compilers, P means compling with OpenMP compilers.

Serial, Iteration number = 100

Gridsize  Jacobi time (S)    GS time (S)
100          0.0102            0.0096
1000         0.8568            0.8325
5000        21.0040            20.3647


Thread number = 4, Iteration number = 100

Gridsize  Jacobi time (P)    GS time (P)

100          0.0042            0.0041
1000         0.2196            0.2230
5000         5.3698            5.5069


Thread number = 10, Iteration number = 100

Gridsize  Jacobi time (P)    GS time (P)

100          0.0059            0.0058
1000         0.0959            0.0951
5000         2.2052            2.5235


